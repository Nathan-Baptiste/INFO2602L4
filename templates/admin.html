{% extends "layout.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block page %}Admin Dashboard{% endblock %}

{% block link%}
<ul id="nav-mobile" class="right">
  <li><a href="/logout">Logout</a></li>
</ul>
{% endblock %}

{% block content %}
<main class="container" style="padding-top: 75px">
  <h3>Admin Dashboard</h3>
  <p>Welcome, {{ current_user.username }}!</p>

  <div class="card">
    <div class="card-content">
      <span class="card-title">All Todos</span>
      <table class="striped">
        <thead>
          <tr>
              <th>ID</th>
              <th>User</th>
              <th>Text</th>
              <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for todo in todos %}
          <tr>
            <td>{{ todo.id }}</td>
            <td>{{ todo.user.username }}</td>
            <td>{{ todo.text }}</td>
            <td>{% if todo.done %}Completed{% else %}Pending{% endif %}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      {% if todos.has_prev or todos.has_next %}
      <div class="pagination" style="margin-top: 20px;">
        {% if todos.has_prev %}
        <a href="{{ url_for('admin_page', page=todos.prev_num, q=q) }}" class="btn-small">&laquo; Previous</a>
        {% endif %}

        <span class="btn-small disabled">Page {{ todos.page }} of {{ todos.pages }}</span>

        {% if todos.has_next %}
        <a href="{{ url_for('admin_page', page=todos.next_num, q=q) }}" class="btn-small">Next &raquo;</a>
        {% endif %}
      </div>
      {% endif %}
    </div>
  </div>

  <div class="card" style="margin-top: 20px;">
    <div class="card-content">
      <span class="card-title">Search Todos</span>
      <form action="{{ url_for('admin_page') }}" method="GET">
        <div class="input-field">
          <input type="text" name="q" value="{{ q }}" placeholder="Search by username or todo text">
        </div>
        <button type="submit" class="btn">Search</button>
      </form>
    </div>
  </div>
</main>
{% endblock %}